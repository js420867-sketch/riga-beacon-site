(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[929],{6663:function(e,t,a){Promise.resolve().then(a.bind(a,5945))},5945:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return r}});var s=a(7437),l=a(2265),n=a(6634),u=a(9376);function r(){let{id:e}=(0,u.useParams)(),t=(0,u.useRouter)(),[a,r]=(0,l.useState)(!0),[i,o]=(0,l.useState)(""),[c,d]=(0,l.useState)(""),[p,f]=(0,l.useState)(""),[m,h]=(0,l.useState)(""),[v,x]=(0,l.useState)("draft"),[g,b]=(0,l.useState)(null);(0,l.useEffect)(()=>{(async()=>{let{data:t}=await n.O.from("posts").select("*").eq("id",e).single();if(t){var a;o(t.title||""),d(t.slug||""),f(t.excerpt||""),h((null===(a=t.content)||void 0===a?void 0:a.html)||""),x(t.status||"draft")}r(!1)})()},[e]);let N=async a=>{let s;if(a.preventDefault(),g){let e="posts/".concat(Date.now(),"_").concat(g.name),{error:t}=await n.O.storage.from("media").upload(e,g);t||(s=n.O.storage.from("media").getPublicUrl(e).data.publicUrl)}await n.O.from("posts").update({title:i,slug:c,excerpt:p,content:{html:m},status:v,...s?{cover_url:s}:{}}).eq("id",e),t.push("/admin/posts")};return a?(0,s.jsx)("div",{children:"Notiek ielāde…"}):(0,s.jsxs)("div",{className:"max-w-2xl",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Rediģēt rakstu"}),(0,s.jsxs)("form",{onSubmit:N,className:"space-y-3",children:[(0,s.jsx)("input",{className:"border p-2 w-full",placeholder:"Nosaukums",value:i,onChange:e=>o(e.target.value)}),(0,s.jsx)("input",{className:"border p-2 w-full",placeholder:"Slugs",value:c,onChange:e=>d(e.target.value)}),(0,s.jsx)("textarea",{className:"border p-2 w-full",placeholder:"Kopsavilkums",value:p,onChange:e=>f(e.target.value)}),(0,s.jsx)("textarea",{className:"border p-2 w-full min-h-[200px]",placeholder:"Saturs (HTML vai teksts)",value:m,onChange:e=>h(e.target.value)}),(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,s.jsx)("input",{type:"file",onChange:e=>{var t;return b((null===(t=e.target.files)||void 0===t?void 0:t[0])||null)}}),(0,s.jsxs)("select",{value:v,onChange:e=>x(e.target.value),className:"border p-2",children:[(0,s.jsx)("option",{value:"draft",children:"Melnraksts"}),(0,s.jsx)("option",{value:"published",children:"Publicēts"})]})]}),(0,s.jsx)("button",{className:"bg-black text-white px-4 py-2",children:"Saglabāt"})]})]})}},6634:function(e,t,a){"use strict";a.d(t,{O:function(){return n}});var s=a(3053),l=a(257);let n=(0,s.eI)(l.env.NEXT_PUBLIC_SUPABASE_URL,l.env.NEXT_PUBLIC_SUPABASE_ANON_KEY)}},function(e){e.O(0,[383,971,117,744],function(){return e(e.s=6663)}),_N_E=e.O()}]);